<!DOCTYPE html>
<html lang="en" class="h-full scroll-smooth">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Trip Details - Travel Adventures</title>
  <meta name="description" content="Details for your next adventure.">
  
  <link rel="stylesheet" href="/src/main.css">
  <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
</head>
<body class="flex h-full flex-col bg-white antialiased">
  
  <header class="py-6">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8">
      <nav class="relative z-50 flex justify-between">
        <div class="flex items-center md:gap-x-12">
          <a href="/" aria-label="Home" class="flex items-center">
            <span class="text-2xl font-bold text-slate-900">Travel Adventures</span>
          </a>
        </div>
        <div class="hidden md:flex md:gap-x-6 items-center">
          <a href="/" class="inline-block rounded-lg px-2 py-1 text-sm text-slate-700 hover:bg-slate-100 hover:text-slate-900">Home</a>
        </div>
      </nav>
    </div>
  </header>
  
  <main class="flex-auto">
    
    <section class="relative overflow-hidden">
      <img id="hero-image" src="" alt="" class="h-96 w-full object-cover bg-slate-200">
      <div class="absolute inset-0 bg-slate-900/25"></div>
      <div class="container mx-auto px-4 sm:px-6 lg:px-8 relative">
        <div class="absolute bottom-8">
          <h1 id="trip-title" class="font-display text-4xl tracking-tight text-white sm:text-6xl">
            Loading Trip...
          </h1>
        </div>
      </div>
    </section>
    
    <section class="py-20 sm:py-32">
      <div class="container mx-auto px-4 sm:px-6 lg:px-8">
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-12">
          <div class="lg:col-span-2">
            <!-- Detailed Itinerary -->
            <div>
              <h2 class="text-2xl font-bold tracking-tight text-slate-900">Detailed Itinerary</h2>
              <div id="itinerary-container" class="mt-8 space-y-8">
                <!-- Itinerary will be loaded here -->
              </div>
            </div>

            <!-- Inclusions & Exclusions -->
            <div class="mt-16">
              <h2 class="text-2xl font-bold tracking-tight text-slate-900">Inclusions & Exclusions</h2>
              <div class="mt-8 grid grid-cols-1 md:grid-cols-2 gap-8">
                <div>
                  <h3 class="text-lg font-semibold text-slate-900">Inclusions</h3>
                  <ul id="inclusions-list" class="mt-4 space-y-2 text-slate-600 list-disc list-inside">
                    <!-- Inclusions will be loaded here -->
                  </ul>
                </div>
                <div>
                  <h3 class="text-lg font-semibold text-slate-900">Exclusions</h3>
                  <ul id="exclusions-list" class="mt-4 space-y-2 text-slate-600 list-disc list-inside">
                    <!-- Exclusions will be loaded here -->
                  </ul>
                </div>
              </div>
            </div>
          </div>

          <!-- Booking Section -->
          <div id="booking-section" x-data="{ travelers: 1, pricePerPerson: 0 }" class="bg-slate-50 rounded-2xl p-8 shadow-lg">
            <h2 class="text-2xl font-bold tracking-tight text-slate-900">Book Your Trip</h2>
            
            <div class="mt-4" x-show="pricePerPerson > 0">
              <p class="text-lg font-semibold text-slate-900">
                Price: <span x-text="new Intl.NumberFormat('en-IN', { style: 'currency', currency: 'INR' }).format(travelers * pricePerPerson)"></span>
              </p>
              <p class="text-sm text-slate-600" x-show="travelers > 1">
                (<span x-text="new Intl.NumberFormat('en-IN', { style: 'currency', currency: 'INR', minimumFractionDigits: 0 }).format(pricePerPerson)"></span> / person)
              </p>
            </div>
            
            <div class="mt-8" x-show="pricePerPerson > 0">
              <label for="travelers" class="block text-sm font-medium text-slate-700">Number of Travelers</label>
              <div class="mt-1 flex items-center">
                <button @click="travelers = Math.max(1, travelers - 1)" type="button" class="px-3 py-1 border border-slate-300 rounded-l-md">-</button>
                <input type="number" x-model.number="travelers" min="1" class="w-16 text-center border-t border-b border-slate-300">
                <button @click="travelers++" type="button" class="px-3 py-1 border border-slate-300 rounded-r-md">+</button>
              </div>
            </div>

            <div class="mt-8">
              <label for="date" class="block text-sm font-medium text-slate-700">Select a Date</label>
              <input type="date" id="date" name="date" class="mt-1 block w-full rounded-md border-slate-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm">
            </div>

            <div class="mt-8">
              <button class="w-full rounded-full bg-blue-600 px-6 py-3 text-sm font-semibold text-white hover:bg-blue-700">Book Now</button>
            </div>
          </div>
        </div>
      </div>
    </section>
    
  </main>
  
  <footer class="bg-slate-900 text-white">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-16">
      <div class="text-center text-slate-400 text-sm">
        <p>&copy; <span x-text="new Date().getFullYear()"></span> Travel Adventures. All rights reserved.</p>
      </div>
    </div>
  </footer>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const params = new URLSearchParams(window.location.search);
      const tripId = params.get('trip');

      if (tripId) {
        fetch(`/trips/${tripId}.json`)
          .then(response => {
            if (!response.ok) {
              throw new Error('Trip not found');
            }
            return response.json();
          })
          .then(data => {
            document.title = `Trip Details - ${data.title}`;
            
            document.getElementById('hero-image').src = data.image.src;
            document.getElementById('hero-image').alt = data.image.alt;
            document.getElementById('trip-title').textContent = data.title;

            const itineraryContainer = document.getElementById('itinerary-container');
            itineraryContainer.innerHTML = ''; // Clear loading state
            data.itinerary.forEach(day => {
              const dayDiv = document.createElement('div');
              dayDiv.innerHTML = `
                <h3 class="text-lg font-semibold text-slate-900">Day ${day.day}: ${day.title}</h3>
                <p class="mt-2 text-slate-600">${day.description}</p>
              `;
              itineraryContainer.appendChild(dayDiv);
            });

            const inclusionsList = document.getElementById('inclusions-list');
            inclusionsList.innerHTML = '';
            data.inclusions.forEach(item => {
              const li = document.createElement('li');
              li.textContent = item;
              inclusionsList.appendChild(li);
            });

            const exclusionsList = document.getElementById('exclusions-list');
            exclusionsList.innerHTML = '';
            data.exclusions.forEach(item => {
              const li = document.createElement('li');
              li.textContent = item;
              exclusionsList.appendChild(li);
            });

            const bookingSection = document.getElementById('booking-section');
            const alpineComponent = Alpine.closest(bookingSection, '[x-data]');
            if (alpineComponent) {
              alpineComponent._x_dataStack[0].pricePerPerson = data.price;
            }
          })
          .catch(error => {
            console.error('Error fetching trip data:', error);
            document.getElementById('trip-title').textContent = 'Trip Not Found';
          });
      } else {
        document.getElementById('trip-title').textContent = 'No Trip Selected';
      }
    });
  </script>
  
</body>
</html>